using System.Collections;
using System.Collections.Generic;
using TMPro;
using UnityEngine;
using UnityEngine.UI;

public class BookScript : MonoBehaviour
{
    string book1 = "Том I\r\n\r\nДавным-давно, в лесном королевстве... Какие легенды оно хранило?\r\nПринцесса-кабан, Часть 1. История о дружбе, любви и смерти.\r\nВ старых легендах говорится, что у всех зверей на земле были свои королевства.\r\nТогда на месте Мондштадта был обычный лес, где резвились дикие кабаны.\r\nЭто было их королевством, в котором они все счастливо жили под властью короля-кабана.\r\nУ короля была прелестная дочь. Во всём королевстве её рыльце было самым красивым, клыки - самыми белыми, а мех - самым гладким.\r\nКрасавица-принцесса каждый день раздавала своим подданным самые сладкие и сочные фрукты.\r\nСладкая малина, хрустящие яблоки, ароматные грибы - всем принцесса сначала делилась с товарищами.\r\nВсе кабаны королевства обожали короля и принцессу и каждый день прославляли их:\r\n- Хрю-хрю! Да здравствует наш король! Пока он нами правит, мы никогда не будем голодать!\r\n- Хрю-хрю! Да здравствует Архонт ветра! Он подарил нашему королю такую добрую красавицу-дочь!\r\n\r\nВ уголке страницы крошечным почерком написано: «Папа! Если я ни буду есть конфеты кафдую ночь и буду малица кафдый день, то я стану кабаном? Я хачю быть кабаном, патамушта ани такие вкусные».В старых легендах говорится, что у всех зверей на земле были свои королевства.\r\nТогда на месте Мондштадта был обычный лес, где резвились дикие кабаны.\r\nЭто было их королевством, в котором они все счастливо жили под властью короля-кабана.\r\nУ короля была прелестная дочь. Во всём королевстве её рыльце было самым красивым, клыки - самыми белыми, а мех - самым гладким.\r\nКрасавица-принцесса каждый день раздавала своим подданным самые сладкие и сочные фрукты.\r\nСладкая малина, хрустящие яблоки, ароматные грибы - всем принцесса сначала делилась с товарищами.\r\nВсе кабаны королевства обожали короля и принцессу и каждый день прославляли их:\r\n- Хрю-хрю! Да здравствует наш король! Пока он нами правит, мы никогда не будем голодать!\r\n- Хрю-хрю! Да здравствует Архонт ветра! Он подарил нашему королю такую добрую красавицу-дочь!\r\n\r\nВ уголке страницы крошечным почерком написано: «Папа! Если я ни буду есть конфеты кафдую ночь и буду малица кафдый день, то я стану кабаном? Я хачю быть кабаном, патамушта ани такие вкусные».\r\n\r\n<page>Том II\r\n\r\nБезжизненное ледяное поле, земля, которую никогда не посещал нежный Архонт Анемо. Почему же она всё ещё населена своими одинокими обитателями?\r\nПринцесса-кабан, Часть 2. История продолжается на леднике.\r\n\r\nК северу от кабаньего леса была мёрзлая тундра.\r\nТогда эти земли были покрыты снегом, потому что игривый Барбатос ещё не добрался до них.\r\nЗвери, зашедшие сюда, рисковали отморозить себе лапы и копыта.\r\n- Холодно, так холодно! - кричали они. - У меня когти вот-вот отвалятся!\r\nДаже самый храбрый и сильный кабаний король не мог устоять перед ледяной тундрой.\r\n- Хрю-хрю! Как холодно! У меня копыта уже от холода посинели!\r\nИ жил в тех землях только один волчонок...\r\n\r\nВнизу страницы под текстом написано детским почерком: «Папа, а пачиму у волка когти не атвалились?»";

    string book2 = "Том III\r\n\r\n«Отныне ты будешь лишён надежды!» Какая судьба ждёт волчонка с таким жестоким проклятием?\r\nПринцесса-кабан, Часть 3.\r\nВолчонок был беззаботным ребёнком с ярко-голубыми глазами и гладким серым мехом.\r\nКогда он начинал злиться, то выглядел прямо как изображение волка перед собором Барбатоса.\r\nНо однажды во время охоты в лесу он встретил злого колдуна - белку Вубаку!\r\nВ древних землях ни одно существо, ни демоны и ни драконы не были злее, чем Вубака! Он презирал всё хорошее и клялся превратить красоту в уродство, а свет - во тьму.\r\nОн увидал счастливого волчонка, и гнев закипел в нём! Он сказал про себя:\r\n- Пик! Пик! Я само зло! Я буду пронзать его сердце ледяным холодом, пока он не потеряет всю надежду!\r\nСказав это, Вубака начал накладывать своё магическое проклятье на волчонка.\r\nНо безрассудный волчонок съел его без всяких объяснений!\r\nВубака был так взбешён, что начал говорить самые вульгарные и оскорбительные слова, которые когда-либо знал! Волчонок почувствовал, как во рту у него кто-то разговаривает, и только тогда он понял, что совершил ошибку.\r\n- Аууу, простите, мистер белка. Я думал, вы съедобен!\r\nВолчонок хотел извиниться перед белкой, но когда его горло сжалось и расслабилось, белка с шумом упала ему на живот.\r\n\r\nК странице приклеен листок бумаги с важными указаниями: «Лили, вот почему ты должна внимательно смотреть, что кладёшь себе в рот, когда находишься на улице».\r\n\r\n<page>Том IV\r\n\r\nТайное прошлое росшего в холодном одиночестве волчонка.\r\nПринцесса-кабан, Часть 4.\r\nНикто не знал, какая химия творилась в желудке волчонка, но проклятие Вубаки волшебным образом вступило в силу!\r\nХолодная льдинка пронзила и заморозила сердце щенка. С тех пор волчонок стал холодным и злым, и когда другие животные заботились о нём, он отвечал им только самыми грубыми словами или самыми злыми поступками. В конце концов все животные возненавидели его.\r\nС тех пор каждый волк в лесу говорил о щенке:\r\n- Гав! Какой же он эгоистичный волчонок! Такой несносный ребёнок.\r\n- Гав, гав! Какой же он бессердечный волк! Давайте держаться от него подальше.\r\nВолчонок терял своих друзей одного за другим. Лес больше не приветствовал одинокого щеночка, так что ему ничего не оставалось, как направиться на север.\r\nНа севере была тундра, снежная буря не пускала сюда никаких зверей. Но когда его сердце замерзло, волчонок больше не боялся холода.\r\nОн решил поселиться в этих краях и стал одиноким волком, который бродил по заснеженной тундре.\r\n\r\nВ уголке страницы есть надпись, сделанная маленькой девочкой: «Папа, а куда делся Вубака?»";

    string book3 = "Том V\r\n\r\n«Никто не заслуживает такой участи!» Добрая принцесса проливает слезу сострадания. Стремление должно растопить лёд.\r\nПринцесса-кабан, Часть 5.\r\nОднажды принцесса-кабан услышала о волчонке и была глубоко опечалена этим рассказом.\r\nПринцесса пыталась разузнать у своих друзей, как разморозить его сердце и вернуть прежнего сладкого щеночка.\r\nОна всё спрашивала и спрашивала, но только мудрая лиса и старая черепаха знали ответ.\r\n- Фыр-фыр-фыр! Только искренность и огонь могут растопить такой злой лёд. Фыр-фыр! - ответила лиса.\r\n- Дружба требует жертв. Без жертв не случится дружбы. Я прошу прощения за то, что не умею издавать смешные звуки. - сказала бабушка-черепаха.\r\nСообразительная принцесса сразу же поняла, что ей следует делать. Она вытерла слёзы и сделала реверанс двум мудрым животным:\r\n- Хрю-хрю! Спасибо! Я бы хотела, чтобы вы пошли посмотреть на волчонка вместе со мной и стали первыми свидетелями нашей дружбы!\r\nКогда лиса и черепаха получили приглашение принцессы, сердца их наполнились радостью. Они отправились вместе с принцессой на север.\r\n\r\nК странице приклеен листок бумаги, на котором, по-видимому, написано отцом девочки: «Черепахи не могут издавать звуки, и мы не можем их заставить. Бабушка-черепаха очень вежливая и поэтому объяснила это принцессе».\r\n\r\n<page>Том VI\r\n\r\nПринцесса и двое её мудрых спутников храбро прошли по ледяным землям и вскарабкались на снежные горы, где встретили таинственный народ...\r\n«Принцесса-кабан», Том VI. Приключения в горах продолжаются!\r\nНа первой странице неуверенным почерком написано: «Папа, когда ты вернёшься, почитай мне сказку о снежных горах!»\r\nИ вот принцесса с двумя мудрецами отправились в далёкую северную тундру.\r\nВ тундре кругом только лёд и снег, и самый храбрый, самый сильный зверь, или даже хорёк, чемпион по копанию, не смогли бы найти здесь ни одной сладенькой травиночки, ни одной сочной ягодки.\r\nПринцесса ужасно замёрзла, но она не отступала и смело шла в самое сердце тундры.\r\nЛедяной ветер совсем измучил мудрую лису и благоразумную бабушку-черепаху и они по очереди уговаривали принцессу:\r\n- Фыр-фыр-фыр! Если его величество король узнает, что мы в таком опасном месте, то будет волноваться. Не лучше ли вернуться... Фыр-фыр...\r\n- Да-да. Буран всё сильнее, а мне всё холоднее... Не лучше ли отдохнуть и продолжить путь при хорошей погоде? Прошу прощения, что не умею издавать смешные звуки.\r\nНо упорная принцесса не слушала мудрых советов и решительно продолжала идти вглубь ледяной тундры.\r\nВедь что может быть важнее, чем спасение дорогого друга? Что может быть благороднее, чем поиск утерянной дружбы?\r\nИ вот шли они и шли, пока их лапы и копыта не посинели, пока с носов не свесились сосульки.\r\nНа вершине ледяной горы, на берегу ревущей подо льдом реки, принцесса встретила фею, парившую в холодных порывах ветра.\r\nОна была очень древней и очень мудрой, и хотя у неё не было формы, у неё была сильная магия.\r\n- Хрю-хрю! Вы здесь хозяин? Не могли бы вы провести нас через буран?\r\nВежливо спросила принцесса, топоча онемевшими от холода копытцами.\r\nМудрая лиса и благоразумная бабушка-черепаха с надеждой смотрели на фею, топоча онемевшими от холода лапками.\r\n- Хум-хум...\r\nНевесомая фея ответила:\r\n«Могла бы, но... хум-хум...\r\nНо за это я высосу из вас жизненную силу. Вы будете идти в ледяном ветре и вам будет всё голоднее, всё тяжелее и холоднее. Но вы не умрёте... наверное... хум-хум...»\r\n«Хрю-хрю... Всё же она фея ледяного ветра,» - подумала принцесса\r\nНо со мной самые мудрые и заботливые члены моей семьи - они обязательно что-нибудь придумают!»\r\nПринцесса без сомнений приняла предложение феи, а мудрая лиса и благоразумная бабушка-черепаха даже не успели ничего сказать.\r\n- Хрю-хрю! Это честный обмен! Скорее веди нас к волчонку!\r\nИ вот фея превратилась в морозный поток и повела упорную принцессу через высокие снежные горы...";

    string book4 = "Том VII\r\n\r\nНа замёрзших равнинах всё было не зря. Идеальный конец дружбы, любви, жизни и смерти!\r\nЭто концовка популярной трогательной истории, Принцесса-кабан.\r\nПройдя через жестокий мороз и бурю, принцесса наконец-то встретила волчонка.\r\nОн весь покрылся льдом, его ярко-голубые глаза потускнели, и он даже забыл, как лаять.\r\n- Аууу! Вы пришли как раз вовремя, потому что я ещё не обедал!\r\nУслышав его слова, добрая принцесса не смогла сдержать слёз. Её тёплые слёзы как будто растопили немного льда на краюшке сердца волчонка.\r\n- Аууу! Почему ты плачешь?\r\n- Хрю-хрю! Ты умрёшь здесь с голоду, а я никогда не видела такого несчастья в моём королевстве!\r\n- Я пожертвую всем, чтобы накормить твой голодный желудочек!\r\nВолчонок был ошеломлён её словами.\r\n- Аууууууу! Вы, должно быть, сошли с ума, мадам! Никто никогда не осмеливался говорить мне такие вещи!\r\nНо когда щенок увидел, насколько решительным был её взгляд, замёрзшее сердце снова забилось.\r\n- Нет! - выкрикнула принцесса.\r\n- Я пожертвую двумя самыми мудрыми и заботливыми членами своей семьи, чтобы накормить тебя! Всё это ради нашей дружбы!\r\nЛиса поняла, что имелось в виду, и попыталась убежать, но волчонок и принцесса прижали её к земле. Бабушка-черепаха так испугалась, что забралась в панцирь.\r\nВолчонок и принцесса прекрасно отобедали на снегу. Найдя пещеру, они набрали грибов, развели костёр из мха и поели вкусный черепаший суп.\r\nВпервые волчонок почувствовал радость от того, что делится и заводит друзей. Его замёрзшее сердце растаяло в слезах счастья.\r\nПринцесса взяла волчонка за лапу, и они радостно вернулись домой.\r\n\r\nК последней странице прикреплена карточка с надписью: «Дорогая, лучше всего нам подарить этот сборник рассказов библиотеке».";


    [TextArea(10, 20)]
    [SerializeField] private string content;
    [Space]
    [SerializeField] private TMP_Text leftSide;
    [SerializeField] private TMP_Text rightSide;
    [Space]

    [SerializeField] private TMP_Text leftPage;
    [SerializeField] private TMP_Text rightPage;
    [SerializeField] private TMP_Text cointCnt;
    

    private void OnValidate()
    {
        UpdatePage();

        if (leftSide.text == content)
            return;
        SeturContent();
    }

    public void Book1()
    {
        leftSide.pageToDisplay = 1; rightSide.pageToDisplay = 2;
        UpdatePage();
        content = book1;
        leftSide.text = content;
        rightSide.text = content;
    }

    public void Book2()
    {
        leftSide.pageToDisplay = 1; rightSide.pageToDisplay = 2;
        UpdatePage();
        content = book2;
        leftSide.text = content;
        rightSide.text = content;
    }

    public void Book3()
    {
        leftSide.pageToDisplay = 1; rightSide.pageToDisplay = 2;
        UpdatePage();

        content = book3;
        leftSide.text = content;
        rightSide.text = content;
    }
    public void Book4()
    {
        leftSide.pageToDisplay = 1; rightSide.pageToDisplay = 2;
        UpdatePage();

        content = book4;
        leftSide.text = content;
        rightSide.text = content;
    }
    private void Awake()
    {
        UpdatePage();
        SeturContent();

        int coins = PlayerPrefs.GetInt("coins");
        PlayerPrefs.SetInt("coins", coins);
        cointCnt.text = (coins).ToString();
    }

    private void SeturContent() 
    {
        content = book1;
        leftSide.text = content;
        rightSide.text = content;
    }
    private void UpdatePage()
    {
        leftPage.text = leftSide.pageToDisplay.ToString();
        rightPage.text = rightSide.pageToDisplay.ToString();
    }

    public void PrevPage() 
    {
        if (leftSide.pageToDisplay < 1)
        {
            leftSide.pageToDisplay = 1;
            return;
        }
        if (leftSide.pageToDisplay - 2 > 1)
            leftSide.pageToDisplay -= 2;
        else
            leftSide.pageToDisplay = 1;

        rightSide.pageToDisplay = leftSide.pageToDisplay+1;
        
        UpdatePage();
    }

    public void NextPage() 
    {
        if (rightSide.pageToDisplay >= rightSide.textInfo.pageCount)
            return;
        if (leftSide.pageToDisplay >= leftSide.textInfo.pageCount - 1)
        {
            leftSide.pageToDisplay = leftSide.textInfo.pageCount - 1;
            rightSide.pageToDisplay = leftSide.pageToDisplay + 1;
        }
        else 
        {
            leftSide.pageToDisplay += 2;
            rightSide.pageToDisplay = leftSide.pageToDisplay + 1;
        }

        int coins = PlayerPrefs.GetInt("coins");
        PlayerPrefs.SetInt("coins", coins + 5);
        cointCnt.text = (coins + 5).ToString();

        UpdatePage();
    }
}
